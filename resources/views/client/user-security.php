<?php
$title = 'Bật Bảo Mật 2FA ' . $TN->site('title');
$body['header'] = '

';
$body['footer'] = '

';
require_once __DIR__ . '/../../../core/is_user.php';
require_once __DIR__ . '/header.php';
require_once __DIR__ . '/nav.php';
CheckLogin();
if(isset($_POST['Save']))
{
    $url_image = $getUser['profile_picture'];
    if (check_img('profile_picture') == true) {
        $rand = random('0123456789QWERTYUIOPASDGHJKLZXCVBNM', 3);
        $uploads_dir = 'upload/avatars/avatar_'.$rand.'.png';
        $tmp_name = $_FILES['profile_picture']['tmp_name'];
        $addlogo = move_uploaded_file($tmp_name,$uploads_dir);
        if ($addlogo) {
            $url_image = 'upload/avatars/avatar_'.$rand.'.png';
        }
    }
    $isUpdate= $TN->update("users", array(
        'name'       => xss($_POST['name']),
        'address'       => xss($_POST['address']),
        'profile_picture'         => $url_image,
        'skill'       => xss($_POST['skill']),
        'description'       => xss($_POST['description']),
        'update_date'       => time(),
        'time_session'       => time(),
    ), " `id` = '".$getUser['id']."' ");
    if ($isUpdate) {
        die('<script type="text/javascript">if(!alert("Cập nhật thành công!")){window.history.back().location.reload();}</script>');
    } else {
        die('<script type="text/javascript">if(!alert("Cập nhật thất bại!")){window.history.back().location.reload();}</script>');
    }
}
?>
        <?php require_once('sidebar.php');?>

            <div class="row">
                <div class="col-lg-6">
                    <div class="settings-card">
                        <div class="settings-card-head">
                            <h4>Thêm tài khoản của bạn</h4>
                        </div>
                        <div class="settings-card-body">
                            <p class="mb-3">Sử dụng mã QR hoặc khóa thiết lập trên ứng dụng Google Authenticator để thêm tài khoản của bạn.</p>
                            <div class="form-group mx-auto text-center">
                                <!--?xml version="1.0" encoding="UTF-8"?-->
                                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="200" height="200" viewBox="0 0 200 200">
                                    <rect x="0" y="0" width="200" height="200" fill="#fefefe"></rect>
                                    <g transform="scale(2.469)"><g transform="translate(4,4)">
                                        <path fill-rule="evenodd" d="M13 0L13 1L12 1L12 2L11 2L11 1L8 1L8 2L9 2L9 3L8 3L8 4L9 4L9 3L15 3L15 5L17 5L17 4L20 4L20 3L21 3L21 5L20 5L20 7L21 7L21 6L22 6L22 7L23 7L23 8L24 8L24 10L23 10L23 9L22 9L22 8L21 8L21 9L20 9L20 8L18 8L18 9L17 9L17 10L16 10L16 11L15 11L15 12L14 12L14 13L13 13L13 14L11 14L11 15L10 15L10 13L12 13L12 11L14 11L14 10L15 10L15 9L16 9L16 8L15 8L15 9L14 9L14 8L13 8L13 9L11 9L11 8L12 8L12 7L13 7L13 6L12 6L12 7L11 7L11 6L10 6L10 5L8 5L8 7L9 7L9 6L10 6L10 8L6 8L6 9L8 9L8 11L7 11L7 10L5 10L5 8L0 8L0 9L4 9L4 10L2 10L2 11L1 11L1 12L0 12L0 13L4 13L4 12L6 12L6 13L8 13L8 14L9 14L9 16L8 16L8 15L7 15L7 14L5 14L5 15L3 15L3 14L1 14L1 17L0 17L0 18L1 18L1 20L0 20L0 21L2 21L2 22L0 22L0 23L1 23L1 24L0 24L0 26L1 26L1 25L2 25L2 26L3 26L3 25L4 25L4 28L3 28L3 29L2 29L2 31L3 31L3 32L5 32L5 30L6 30L6 31L7 31L7 30L6 30L6 29L10 29L10 31L9 31L9 30L8 30L8 31L9 31L9 32L8 32L8 33L9 33L9 32L10 32L10 31L12 31L12 30L13 30L13 31L14 31L14 32L13 32L13 33L12 33L12 32L11 32L11 33L10 33L10 34L6 34L6 33L7 33L7 32L6 32L6 33L5 33L5 34L2 34L2 33L1 33L1 34L0 34L0 35L1 35L1 36L2 36L2 35L3 35L3 36L4 36L4 37L1 37L1 41L5 41L5 39L4 39L4 37L5 37L5 38L6 38L6 39L7 39L7 40L6 40L6 41L7 41L7 42L4 42L4 43L3 43L3 42L2 42L2 43L1 43L1 44L2 44L2 45L1 45L1 46L0 46L0 48L1 48L1 49L0 49L0 50L1 50L1 49L3 49L3 50L2 50L2 51L3 51L3 50L6 50L6 51L5 51L5 52L6 52L6 53L5 53L5 54L4 54L4 52L3 52L3 56L2 56L2 55L1 55L1 57L4 57L4 58L6 58L6 59L4 59L4 60L5 60L5 61L4 61L4 62L3 62L3 61L2 61L2 62L1 62L1 60L0 60L0 63L2 63L2 62L3 62L3 64L4 64L4 65L5 65L5 63L8 63L8 62L9 62L9 63L10 63L10 64L11 64L11 66L12 66L12 67L14 67L14 66L15 66L15 65L16 65L16 67L15 67L15 70L16 70L16 67L17 67L17 69L19 69L19 68L18 68L18 67L20 67L20 66L21 66L21 68L20 68L20 69L21 69L21 70L20 70L20 72L19 72L19 70L18 70L18 72L19 72L19 73L21 73L21 71L22 71L22 72L24 72L24 73L26 73L26 71L27 71L27 70L26 70L26 71L25 71L25 69L28 69L28 70L29 70L29 69L30 69L30 72L31 72L31 71L32 71L32 72L34 72L34 73L37 73L37 72L38 72L38 71L39 71L39 70L40 70L40 68L43 68L43 70L41 70L41 71L42 71L42 72L44 72L44 71L45 71L45 73L47 73L47 70L46 70L46 69L49 69L49 65L50 65L50 66L51 66L51 67L50 67L50 69L53 69L53 71L54 71L54 72L52 72L52 70L50 70L50 73L56 73L56 72L57 72L57 73L59 73L59 72L58 72L58 70L57 70L57 71L54 71L54 70L56 70L56 69L57 69L57 68L58 68L58 69L59 69L59 70L61 70L61 68L60 68L60 69L59 69L59 68L58 68L58 66L57 66L57 64L58 64L58 65L59 65L59 66L61 66L61 64L60 64L60 65L59 65L59 64L58 64L58 63L57 63L57 62L59 62L59 61L62 61L62 62L63 62L63 63L62 63L62 67L63 67L63 68L62 68L62 69L64 69L64 70L62 70L62 73L63 73L63 72L64 72L64 70L65 70L65 73L66 73L66 72L67 72L67 73L68 73L68 72L69 72L69 71L71 71L71 73L73 73L73 72L72 72L72 71L73 71L73 67L72 67L72 66L73 66L73 64L71 64L71 67L72 67L72 68L70 68L70 67L69 67L69 64L65 64L65 63L64 63L64 62L63 62L63 61L65 61L65 62L66 62L66 63L71 63L71 62L73 62L73 58L72 58L72 57L71 57L71 58L69 58L69 57L68 57L68 55L67 55L67 54L68 54L68 51L69 51L69 50L70 50L70 52L71 52L71 51L73 51L73 48L72 48L72 47L73 47L73 46L72 46L72 45L73 45L73 44L72 44L72 45L71 45L71 46L70 46L70 43L73 43L73 34L72 34L72 33L73 33L73 32L72 32L72 31L73 31L73 30L72 30L72 29L73 29L73 28L72 28L72 27L73 27L73 26L72 26L72 27L71 27L71 26L70 26L70 27L71 27L71 28L72 28L72 29L71 29L71 30L72 30L72 31L71 31L71 34L70 34L70 35L69 35L69 37L71 37L71 38L69 38L69 41L67 41L67 40L66 40L66 41L65 41L65 39L63 39L63 40L62 40L62 41L61 41L61 38L60 38L60 40L58 40L58 38L59 38L59 37L56 37L56 38L57 38L57 39L56 39L56 43L57 43L57 44L51 44L51 43L52 43L52 42L53 42L53 41L54 41L54 42L55 42L55 40L53 40L53 41L52 41L52 42L51 42L51 41L50 41L50 40L52 40L52 38L53 38L53 37L52 37L52 38L51 38L51 39L50 39L50 40L49 40L49 41L48 41L48 43L50 43L50 44L46 44L46 42L47 42L47 41L45 41L45 42L44 42L44 41L43 41L43 39L44 39L44 38L45 38L45 40L46 40L46 38L48 38L48 39L49 39L49 38L50 38L50 37L51 37L51 36L52 36L52 34L50 34L50 36L49 36L49 34L48 34L48 35L47 35L47 34L46 34L46 33L45 33L45 32L46 32L46 31L45 31L45 32L43 32L43 31L44 31L44 30L43 30L43 29L45 29L45 30L46 30L46 29L47 29L47 32L48 32L48 31L50 31L50 32L49 32L49 33L50 33L50 32L51 32L51 33L53 33L53 32L52 32L52 30L51 30L51 31L50 31L50 30L48 30L48 29L49 29L49 27L50 27L50 29L53 29L53 28L52 28L52 26L56 26L56 28L58 28L58 29L59 29L59 30L58 30L58 31L57 31L57 30L56 30L56 29L54 29L54 30L53 30L53 31L55 31L55 30L56 30L56 32L58 32L58 31L59 31L59 30L60 30L60 32L61 32L61 29L62 29L62 28L63 28L63 29L66 29L66 30L67 30L67 32L68 32L68 30L69 30L69 32L70 32L70 30L69 30L69 29L70 29L70 28L69 28L69 24L70 24L70 25L71 25L71 24L72 24L72 23L73 23L73 20L72 20L72 19L73 19L73 18L72 18L72 17L73 17L73 16L72 16L72 15L73 15L73 12L72 12L72 11L73 11L73 9L72 9L72 8L71 8L71 9L72 9L72 11L71 11L71 10L69 10L69 11L70 11L70 13L69 13L69 12L68 12L68 10L67 10L67 12L66 12L66 13L65 13L65 14L64 14L64 15L63 15L63 13L64 13L64 11L65 11L65 10L66 10L66 8L65 8L65 6L64 6L64 7L63 7L63 5L65 5L65 4L64 4L64 3L62 3L62 4L61 4L61 2L63 2L63 0L62 0L62 1L61 1L61 0L59 0L59 1L58 1L58 0L57 0L57 1L56 1L56 0L55 0L55 1L53 1L53 0L52 0L52 1L51 1L51 3L49 3L49 4L46 4L46 3L45 3L45 4L44 4L44 1L45 1L45 2L49 2L49 1L50 1L50 0L48 0L48 1L47 1L47 0L44 0L44 1L43 1L43 2L42 2L42 1L41 1L41 3L43 3L43 4L44 4L44 5L42 5L42 4L40 4L40 2L39 2L39 1L40 1L40 0L39 0L39 1L38 1L38 0L37 0L37 1L36 1L36 0L35 0L35 3L34 3L34 4L35 4L35 3L36 3L36 5L35 5L35 6L34 6L34 5L33 5L33 2L34 2L34 1L33 1L33 0L32 0L32 1L33 1L33 2L32 2L32 3L31 3L31 0L29 0L29 1L28 1L28 0L26 0L26 1L23 1L23 2L24 2L24 3L25 3L25 4L24 4L24 5L22 5L22 4L23 4L23 3L22 3L22 1L21 1L21 2L20 2L20 1L19 1L19 2L20 2L20 3L18 3L18 1L17 1L17 0L16 0L16 3L15 3L15 2L14 2L14 0ZM64 0L64 1L65 1L65 0ZM26 1L26 2L25 2L25 3L26 3L26 2L27 2L27 3L29 3L29 4L30 4L30 6L29 6L29 7L30 7L30 6L31 6L31 8L30 8L30 9L28 9L28 11L27 11L27 13L25 13L25 12L26 12L26 11L25 11L25 10L24 10L24 11L25 11L25 12L24 12L24 13L23 13L23 15L21 15L21 14L20 14L20 13L21 13L21 12L20 12L20 11L21 11L21 10L20 10L20 9L19 9L19 10L17 10L17 11L16 11L16 12L15 12L15 13L17 13L17 15L19 15L19 16L17 16L17 17L16 17L16 14L13 14L13 15L11 15L11 17L10 17L10 16L9 16L9 17L8 17L8 16L7 16L7 15L6 15L6 16L7 16L7 17L5 17L5 18L4 18L4 19L3 19L3 22L5 22L5 21L6 21L6 22L7 22L7 21L6 21L6 20L8 20L8 23L9 23L9 25L10 25L10 24L11 24L11 23L9 23L9 22L12 22L12 23L14 23L14 24L13 24L13 25L14 25L14 24L15 24L15 27L16 27L16 28L14 28L14 29L16 29L16 28L19 28L19 29L20 29L20 30L21 30L21 29L23 29L23 30L22 30L22 31L23 31L23 32L17 32L17 31L18 31L18 29L17 29L17 30L14 30L14 31L15 31L15 32L14 32L14 33L17 33L17 34L16 34L16 36L14 36L14 37L13 37L13 36L10 36L10 35L9 35L9 37L11 37L11 38L8 38L8 37L6 37L6 38L7 38L7 39L8 39L8 40L7 40L7 41L8 41L8 42L7 42L7 43L4 43L4 44L9 44L9 43L8 43L8 42L9 42L9 41L10 41L10 42L11 42L11 43L10 43L10 44L11 44L11 47L12 47L12 44L11 44L11 43L13 43L13 44L15 44L15 43L16 43L16 46L17 46L17 47L19 47L19 49L18 49L18 48L15 48L15 49L14 49L14 48L13 48L13 49L10 49L10 47L9 47L9 49L6 49L6 50L7 50L7 51L6 51L6 52L7 52L7 51L8 51L8 52L9 52L9 54L7 54L7 53L6 53L6 54L5 54L5 56L4 56L4 57L6 57L6 58L7 58L7 57L8 57L8 59L9 59L9 58L10 58L10 59L11 59L11 60L13 60L13 61L14 61L14 60L15 60L15 62L16 62L16 63L14 63L14 62L11 62L11 61L10 61L10 60L9 60L9 62L11 62L11 63L14 63L14 64L16 64L16 65L19 65L19 66L20 66L20 65L21 65L21 66L24 66L24 64L25 64L25 61L28 61L28 62L27 62L27 63L26 63L26 64L27 64L27 63L28 63L28 64L29 64L29 65L31 65L31 66L32 66L32 68L33 68L33 65L34 65L34 68L35 68L35 69L33 69L33 70L32 70L32 69L31 69L31 68L30 68L30 67L29 67L29 68L30 68L30 69L31 69L31 70L32 70L32 71L33 71L33 70L35 70L35 71L34 71L34 72L35 72L35 71L36 71L36 70L37 70L37 71L38 71L38 70L39 70L39 69L38 69L38 68L39 68L39 67L41 67L41 65L44 65L44 63L45 63L45 64L46 64L46 63L47 63L47 64L48 64L48 62L49 62L49 64L50 64L50 65L51 65L51 66L52 66L52 68L54 68L54 69L56 69L56 68L57 68L57 66L54 66L54 67L53 67L53 64L54 64L54 65L56 65L56 62L55 62L55 61L56 61L56 57L57 57L57 59L58 59L58 60L57 60L57 61L59 61L59 59L60 59L60 60L62 60L62 61L63 61L63 60L62 60L62 58L63 58L63 57L62 57L62 55L63 55L63 56L64 56L64 55L65 55L65 56L67 56L67 55L66 55L66 54L67 54L67 51L66 51L66 50L65 50L65 49L64 49L64 50L65 50L65 51L63 51L63 52L66 52L66 54L64 54L64 53L63 53L63 54L62 54L62 50L63 50L63 49L62 49L62 46L63 46L63 47L64 47L64 46L63 46L63 45L62 45L62 43L63 43L63 44L64 44L64 42L65 42L65 44L66 44L66 42L65 42L65 41L64 41L64 40L63 40L63 41L62 41L62 42L61 42L61 41L58 41L58 42L59 42L59 44L57 44L57 45L58 45L58 46L59 46L59 47L60 47L60 46L59 46L59 45L60 45L60 44L61 44L61 48L59 48L59 49L58 49L58 50L57 50L57 51L56 51L56 50L55 50L55 51L54 51L54 49L55 49L55 48L57 48L57 47L56 47L56 46L54 46L54 45L51 45L51 44L50 44L50 45L49 45L49 46L50 46L50 47L49 47L49 49L47 49L47 50L46 50L46 51L45 51L45 49L44 49L44 50L43 50L43 52L42 52L42 53L41 53L41 50L42 50L42 49L43 49L43 48L44 48L44 47L43 47L43 48L42 48L42 47L41 47L41 46L39 46L39 43L40 43L40 44L41 44L41 45L43 45L43 46L44 46L44 43L43 43L43 42L42 42L42 40L39 40L39 38L40 38L40 39L41 39L41 38L40 38L40 37L39 37L39 35L38 35L38 34L39 34L39 33L42 33L42 32L41 32L41 30L42 30L42 29L43 29L43 28L44 28L44 27L43 27L43 28L42 28L42 27L41 27L41 26L40 26L40 25L43 25L43 26L44 26L44 25L43 25L43 24L44 24L44 22L46 22L46 23L47 23L47 24L48 24L48 23L49 23L49 26L50 26L50 27L51 27L51 26L52 26L52 25L50 25L50 24L51 24L51 22L52 22L52 21L50 21L50 22L48 22L48 23L47 23L47 21L45 21L45 20L48 20L48 21L49 21L49 20L50 20L50 19L51 19L51 18L52 18L52 17L50 17L50 18L48 18L48 16L50 16L50 14L52 14L52 15L53 15L53 16L54 16L54 15L53 15L53 14L55 14L55 15L56 15L56 16L55 16L55 18L54 18L54 17L53 17L53 20L55 20L55 19L56 19L56 17L59 17L59 16L62 16L62 18L63 18L63 19L61 19L61 18L57 18L57 19L58 19L58 20L56 20L56 21L55 21L55 22L54 22L54 21L53 21L53 24L55 24L55 25L56 25L56 26L57 26L57 24L56 24L56 21L60 21L60 20L62 20L62 21L61 21L61 22L57 22L57 23L58 23L58 24L60 24L60 23L61 23L61 25L58 25L58 26L59 26L59 27L58 27L58 28L59 28L59 29L61 29L61 28L62 28L62 27L63 27L63 26L64 26L64 25L63 25L63 26L62 26L62 24L63 24L63 23L64 23L64 24L68 24L68 23L69 23L69 22L71 22L71 23L70 23L70 24L71 24L71 23L72 23L72 20L71 20L71 19L72 19L72 18L71 18L71 15L69 15L69 13L68 13L68 12L67 12L67 13L66 13L66 14L65 14L65 15L64 15L64 17L65 17L65 16L67 16L67 15L66 15L66 14L68 14L68 20L67 20L67 23L66 23L66 21L64 21L64 20L66 20L66 19L64 19L64 18L63 18L63 16L62 16L62 13L60 13L60 12L57 12L57 11L58 11L58 10L59 10L59 11L61 11L61 12L62 12L62 11L61 11L61 9L60 9L60 8L59 8L59 9L56 9L56 8L57 8L57 7L58 7L58 6L57 6L57 4L58 4L58 5L59 5L59 7L60 7L60 6L61 6L61 8L62 8L62 10L63 10L63 8L62 8L62 5L63 5L63 4L62 4L62 5L61 5L61 4L60 4L60 2L61 2L61 1L59 1L59 3L56 3L56 1L55 1L55 2L52 2L52 3L51 3L51 4L49 4L49 5L52 5L52 3L55 3L55 4L53 4L53 5L55 5L55 7L54 7L54 6L53 6L53 7L52 7L52 6L51 6L51 7L52 7L52 8L50 8L50 6L49 6L49 8L50 8L50 9L49 9L49 12L50 12L50 13L49 13L49 14L48 14L48 13L47 13L47 12L48 12L48 11L47 11L47 12L46 12L46 13L45 13L45 9L44 9L44 6L43 6L43 8L42 8L42 5L40 5L40 4L39 4L39 2L38 2L38 1L37 1L37 2L38 2L38 4L37 4L37 5L39 5L39 7L38 7L38 6L37 6L37 8L39 8L39 9L37 9L37 12L35 12L35 10L36 10L36 8L35 8L35 7L36 7L36 6L35 6L35 7L34 7L34 6L33 6L33 5L32 5L32 4L31 4L31 3L29 3L29 2L28 2L28 1ZM16 3L16 4L17 4L17 3ZM11 4L11 5L14 5L14 4ZM55 4L55 5L56 5L56 4ZM18 5L18 7L19 7L19 5ZM25 5L25 8L28 8L28 5ZM45 5L45 8L48 8L48 5ZM14 6L14 7L15 7L15 6ZM16 6L16 7L17 7L17 6ZM23 6L23 7L24 7L24 6ZM26 6L26 7L27 7L27 6ZM32 6L32 8L33 8L33 9L32 9L32 10L31 10L31 9L30 9L30 10L29 10L29 12L32 12L32 14L31 14L31 13L30 13L30 14L29 14L29 16L28 16L28 15L26 15L26 16L25 16L25 15L23 15L23 16L21 16L21 15L20 15L20 16L19 16L19 17L17 17L17 18L16 18L16 17L14 17L14 15L13 15L13 17L12 17L12 18L11 18L11 19L10 19L10 18L8 18L8 17L7 17L7 18L6 18L6 19L5 19L5 20L4 20L4 21L5 21L5 20L6 20L6 19L7 19L7 18L8 18L8 19L10 19L10 20L9 20L9 21L11 21L11 20L12 20L12 19L15 19L15 20L14 20L14 21L12 21L12 22L14 22L14 23L15 23L15 24L18 24L18 25L19 25L19 23L17 23L17 18L18 18L18 20L19 20L19 19L20 19L20 21L18 21L18 22L20 22L20 25L23 25L23 26L24 26L24 27L22 27L22 26L21 26L21 28L20 28L20 29L21 29L21 28L24 28L24 30L23 30L23 31L24 31L24 32L23 32L23 33L21 33L21 34L20 34L20 37L21 37L21 38L20 38L20 41L21 41L21 42L19 42L19 41L16 41L16 43L17 43L17 42L18 42L18 43L20 43L20 44L21 44L21 45L20 45L20 46L21 46L21 47L20 47L20 49L21 49L21 50L22 50L22 52L23 52L23 53L21 53L21 51L20 51L20 50L19 50L19 51L18 51L18 52L19 52L19 53L18 53L18 54L19 54L19 53L21 53L21 54L20 54L20 55L21 55L21 56L20 56L20 57L22 57L22 56L25 56L25 55L27 55L27 57L23 57L23 58L19 58L19 57L18 57L18 59L17 59L17 60L16 60L16 59L15 59L15 58L17 58L17 57L16 57L16 56L19 56L19 55L16 55L16 54L13 54L13 53L14 53L14 52L12 52L12 50L8 50L8 51L11 51L11 52L12 52L12 54L11 54L11 53L10 53L10 54L11 54L11 55L10 55L10 56L9 56L9 55L7 55L7 54L6 54L6 55L7 55L7 56L6 56L6 57L7 57L7 56L8 56L8 57L10 57L10 58L11 58L11 59L13 59L13 60L14 60L14 59L15 59L15 60L16 60L16 62L18 62L18 63L16 63L16 64L19 64L19 65L20 65L20 64L21 64L21 65L22 65L22 64L23 64L23 63L22 63L22 62L20 62L20 61L21 61L21 60L23 60L23 61L25 61L25 60L28 60L28 61L29 61L29 62L28 62L28 63L30 63L30 64L31 64L31 63L32 63L32 64L34 64L34 65L37 65L37 66L35 66L35 68L36 68L36 69L35 69L35 70L36 70L36 69L37 69L37 70L38 70L38 69L37 69L37 67L39 67L39 66L40 66L40 64L41 64L41 63L39 63L39 64L38 64L38 63L37 63L37 62L38 62L38 57L39 57L39 58L40 58L40 56L42 56L42 58L41 58L41 60L42 60L42 62L44 62L44 61L46 61L46 62L47 62L47 61L50 61L50 60L51 60L51 61L52 61L52 60L53 60L53 61L55 61L55 58L53 58L53 57L55 57L55 56L53 56L53 57L52 57L52 56L51 56L51 55L53 55L53 53L52 53L52 52L51 52L51 51L53 51L53 50L50 50L50 52L49 52L49 50L48 50L48 52L49 52L49 53L50 53L50 52L51 52L51 53L52 53L52 54L50 54L50 56L47 56L47 57L46 57L46 55L47 55L47 54L46 54L46 55L45 55L45 56L44 56L44 53L46 53L46 52L47 52L47 51L46 51L46 52L43 52L43 53L42 53L42 54L43 54L43 55L40 55L40 54L41 54L41 53L39 53L39 52L37 52L37 50L34 50L34 49L35 49L35 48L34 48L34 45L35 45L35 44L38 44L38 43L39 43L39 42L40 42L40 41L39 41L39 40L38 40L38 38L36 38L36 37L37 37L37 36L38 36L38 35L37 35L37 34L36 34L36 33L39 33L39 32L36 32L36 31L37 31L37 30L35 30L35 32L34 32L34 30L33 30L33 29L31 29L31 31L30 31L30 29L29 29L29 28L31 28L31 27L32 27L32 28L34 28L34 29L37 29L37 28L38 28L38 27L37 27L37 25L39 25L39 24L40 24L40 22L41 22L41 23L42 23L42 24L43 24L43 23L42 23L42 22L44 22L44 21L40 21L40 22L39 22L39 21L38 21L38 22L39 22L39 24L36 24L36 26L34 26L34 24L33 24L33 25L32 25L32 22L34 22L34 23L35 23L35 22L36 22L36 23L37 23L37 22L36 22L36 21L37 21L37 20L38 20L38 17L39 17L39 18L40 18L40 16L41 16L41 15L42 15L42 16L43 16L43 17L41 17L41 19L40 19L40 20L45 20L45 19L46 19L46 18L45 18L45 19L43 19L43 17L44 17L44 16L45 16L45 17L47 17L47 16L45 16L45 15L46 15L46 14L45 14L45 15L44 15L44 16L43 16L43 14L44 14L44 12L43 12L43 11L44 11L44 9L42 9L42 8L41 8L41 9L39 9L39 10L38 10L38 11L40 11L40 10L41 10L41 12L40 12L40 14L39 14L39 12L37 12L37 13L38 13L38 15L39 15L39 16L38 16L38 17L37 17L37 18L35 18L35 19L36 19L36 21L35 21L35 20L34 20L34 21L33 21L33 20L31 20L31 18L33 18L33 17L35 17L35 16L37 16L37 14L35 14L35 16L33 16L33 15L32 15L32 14L33 14L33 13L35 13L35 12L34 12L34 11L33 11L33 12L32 12L32 10L33 10L33 9L35 9L35 8L34 8L34 7L33 7L33 6ZM40 6L40 7L41 7L41 6ZM46 6L46 7L47 7L47 6ZM56 6L56 7L55 7L55 8L52 8L52 10L50 10L50 12L51 12L51 11L52 11L52 12L53 12L53 13L52 13L52 14L53 14L53 13L55 13L55 12L56 12L56 11L57 11L57 10L56 10L56 9L55 9L55 8L56 8L56 7L57 7L57 6ZM67 8L67 9L68 9L68 8ZM69 8L69 9L70 9L70 8ZM13 9L13 10L14 10L14 9ZM41 9L41 10L42 10L42 9ZM47 9L47 10L48 10L48 9ZM53 9L53 10L52 10L52 11L53 11L53 12L54 12L54 10L55 10L55 11L56 11L56 10L55 10L55 9ZM64 9L64 10L65 10L65 9ZM9 10L9 11L10 11L10 10ZM19 10L19 11L20 11L20 10ZM30 10L30 11L31 11L31 10ZM2 11L2 12L3 12L3 11ZM6 11L6 12L7 12L7 11ZM8 12L8 13L10 13L10 12ZM17 12L17 13L19 13L19 12ZM41 12L41 13L42 13L42 12ZM71 12L71 13L70 13L70 14L71 14L71 13L72 13L72 12ZM24 13L24 14L25 14L25 13ZM27 13L27 14L28 14L28 13ZM56 13L56 15L57 15L57 16L59 16L59 15L58 15L58 14L59 14L59 13L58 13L58 14L57 14L57 13ZM30 14L30 15L31 15L31 14ZM40 14L40 15L41 15L41 14ZM2 16L2 18L3 18L3 16ZM20 16L20 17L19 17L19 18L20 18L20 19L21 19L21 21L20 21L20 22L21 22L21 21L23 21L23 22L22 22L22 23L21 23L21 24L23 24L23 25L24 25L24 24L23 24L23 23L24 23L24 22L25 22L25 21L23 21L23 20L24 20L24 19L25 19L25 20L26 20L26 23L25 23L25 24L26 24L26 23L27 23L27 24L29 24L29 26L32 26L32 27L33 27L33 26L32 26L32 25L31 25L31 24L29 24L29 23L30 23L30 22L29 22L29 21L31 21L31 22L32 22L32 21L31 21L31 20L29 20L29 18L30 18L30 16L29 16L29 17L28 17L28 16L26 16L26 19L25 19L25 16L24 16L24 18L23 18L23 17L22 17L22 18L20 18L20 17L21 17L21 16ZM31 16L31 17L33 17L33 16ZM27 17L27 19L26 19L26 20L27 20L27 19L28 19L28 17ZM69 18L69 19L71 19L71 18ZM22 19L22 20L23 20L23 19ZM48 19L48 20L49 20L49 19ZM63 19L63 20L64 20L64 19ZM28 20L28 21L27 21L27 23L29 23L29 22L28 22L28 21L29 21L29 20ZM68 20L68 21L69 21L69 20ZM14 21L14 22L15 22L15 23L16 23L16 22L15 22L15 21ZM34 21L34 22L35 22L35 21ZM62 21L62 22L61 22L61 23L62 23L62 22L63 22L63 21ZM64 22L64 23L65 23L65 22ZM3 23L3 24L4 24L4 23ZM5 23L5 24L7 24L7 23ZM5 25L5 28L8 28L8 25ZM25 25L25 28L28 28L28 25ZM45 25L45 28L48 28L48 25ZM65 25L65 28L68 28L68 25ZM6 26L6 27L7 27L7 26ZM9 26L9 28L10 28L10 26ZM13 26L13 27L12 27L12 28L13 28L13 27L14 27L14 26ZM16 26L16 27L17 27L17 26ZM19 26L19 27L20 27L20 26ZM26 26L26 27L27 27L27 26ZM46 26L46 27L47 27L47 26ZM60 26L60 27L59 27L59 28L61 28L61 27L62 27L62 26ZM66 26L66 27L67 27L67 26ZM34 27L34 28L35 28L35 27ZM36 27L36 28L37 28L37 27ZM0 28L0 30L1 30L1 28ZM40 28L40 29L39 29L39 30L38 30L38 31L39 31L39 30L41 30L41 29L42 29L42 28ZM3 29L3 30L4 30L4 29ZM26 29L26 30L24 30L24 31L25 31L25 32L26 32L26 33L25 33L25 34L26 34L26 36L24 36L24 35L22 35L22 36L24 36L24 37L22 37L22 38L23 38L23 39L21 39L21 40L23 40L23 39L24 39L24 37L25 37L25 38L27 38L27 37L28 37L28 39L26 39L26 40L28 40L28 41L26 41L26 42L25 42L25 43L26 43L26 44L27 44L27 43L30 43L30 42L29 42L29 40L28 40L28 39L29 39L29 37L28 37L28 36L27 36L27 35L28 35L28 34L30 34L30 33L31 33L31 34L32 34L32 36L30 36L30 35L29 35L29 36L30 36L30 38L32 38L32 39L33 39L33 40L32 40L32 41L33 41L33 42L32 42L32 45L31 45L31 44L29 44L29 45L30 45L30 46L32 46L32 49L31 49L31 48L29 48L29 49L27 49L27 50L26 50L26 49L24 49L24 45L23 45L23 44L22 44L22 45L23 45L23 47L21 47L21 48L22 48L22 49L23 49L23 52L25 52L25 51L24 51L24 50L26 50L26 52L27 52L27 53L28 53L28 58L29 58L29 57L33 57L33 58L31 58L31 60L30 60L30 59L28 59L28 60L30 60L30 63L31 63L31 61L33 61L33 62L32 62L32 63L34 63L34 64L35 64L35 63L34 63L34 62L37 62L37 61L33 61L33 60L36 60L36 58L37 58L37 57L38 57L38 56L39 56L39 53L36 53L36 54L35 54L35 53L34 53L34 52L36 52L36 51L34 51L34 52L33 52L33 50L32 50L32 49L34 49L34 48L33 48L33 46L32 46L32 45L34 45L34 44L35 44L35 43L36 43L36 42L38 42L38 40L37 40L37 41L35 41L35 39L36 39L36 38L34 38L34 36L35 36L35 37L36 37L36 36L35 36L35 33L36 33L36 32L35 32L35 33L33 33L33 32L30 32L30 31L29 31L29 29L28 29L28 31L27 31L27 29ZM67 29L67 30L68 30L68 29ZM32 30L32 31L33 31L33 30ZM62 30L62 33L57 33L57 34L56 34L56 33L54 33L54 35L55 35L55 34L56 34L56 36L58 36L58 34L61 34L61 35L60 35L60 37L62 37L62 38L63 38L63 37L62 37L62 36L61 36L61 35L64 35L64 34L62 34L62 33L65 33L65 34L66 34L66 36L64 36L64 37L65 37L65 38L66 38L66 39L68 39L68 38L67 38L67 37L68 37L68 35L67 35L67 34L69 34L69 33L66 33L66 31L65 31L65 30L64 30L64 31L63 31L63 30ZM0 31L0 32L1 32L1 31ZM28 31L28 32L27 32L27 34L28 34L28 32L29 32L29 33L30 33L30 32L29 32L29 31ZM64 31L64 32L65 32L65 31ZM11 33L11 35L15 35L15 34L12 34L12 33ZM18 33L18 34L17 34L17 37L19 37L19 36L18 36L18 35L19 35L19 33ZM23 33L23 34L24 34L24 33ZM43 33L43 34L44 34L44 35L43 35L43 36L41 36L41 34L40 34L40 36L41 36L41 37L42 37L42 39L43 39L43 38L44 38L44 37L48 37L48 36L45 36L45 33ZM71 34L71 35L70 35L70 36L72 36L72 34ZM4 35L4 36L8 36L8 35ZM33 35L33 36L32 36L32 38L33 38L33 36L34 36L34 35ZM43 36L43 37L44 37L44 36ZM66 36L66 37L67 37L67 36ZM54 37L54 39L55 39L55 37ZM2 38L2 40L3 40L3 38ZM12 38L12 39L10 39L10 40L12 40L12 41L11 41L11 42L12 42L12 41L13 41L13 43L15 43L15 42L14 42L14 41L15 41L15 40L16 40L16 38ZM18 38L18 39L17 39L17 40L19 40L19 38ZM71 38L71 40L70 40L70 41L69 41L69 42L67 42L67 44L69 44L69 43L70 43L70 42L71 42L71 41L72 41L72 38ZM12 39L12 40L13 40L13 41L14 41L14 40L15 40L15 39L14 39L14 40L13 40L13 39ZM8 40L8 41L9 41L9 40ZM24 40L24 41L22 41L22 43L24 43L24 41L25 41L25 40ZM30 40L30 41L31 41L31 40ZM33 40L33 41L34 41L34 40ZM49 41L49 42L50 42L50 43L51 43L51 42L50 42L50 41ZM63 41L63 42L64 42L64 41ZM33 42L33 44L34 44L34 43L35 43L35 42ZM2 43L2 44L3 44L3 43ZM42 43L42 44L43 44L43 43ZM17 44L17 45L18 45L18 46L19 46L19 44ZM2 45L2 46L3 46L3 47L4 47L4 46L3 46L3 45ZM5 45L5 48L8 48L8 45ZM9 45L9 46L10 46L10 45ZM13 45L13 47L15 47L15 46L14 46L14 45ZM25 45L25 48L28 48L28 45ZM37 45L37 46L35 46L35 47L37 47L37 46L38 46L38 45ZM45 45L45 48L48 48L48 45ZM50 45L50 46L51 46L51 47L50 47L50 49L53 49L53 48L51 48L51 47L52 47L52 46L51 46L51 45ZM65 45L65 48L68 48L68 45ZM6 46L6 47L7 47L7 46ZM26 46L26 47L27 47L27 46ZM46 46L46 47L47 47L47 46ZM66 46L66 47L67 47L67 46ZM69 46L69 47L70 47L70 48L69 48L69 49L68 49L68 50L69 50L69 49L70 49L70 50L71 50L71 49L70 49L70 48L71 48L71 47L72 47L72 46L71 46L71 47L70 47L70 46ZM36 48L36 49L39 49L39 50L40 50L40 48ZM41 48L41 49L42 49L42 48ZM13 49L13 51L16 51L16 52L17 52L17 50L14 50L14 49ZM29 49L29 50L27 50L27 52L28 52L28 53L30 53L30 54L29 54L29 56L31 56L31 55L32 55L32 54L33 54L33 57L35 57L35 58L36 58L36 57L37 57L37 55L38 55L38 54L36 54L36 55L35 55L35 54L33 54L33 53L32 53L32 54L31 54L31 53L30 53L30 52L32 52L32 51L30 51L30 52L28 52L28 51L29 51L29 50L30 50L30 49ZM59 49L59 50L60 50L60 51L57 51L57 52L56 52L56 51L55 51L55 52L56 52L56 56L59 56L59 55L57 55L57 54L58 54L58 53L59 53L59 52L60 52L60 53L61 53L61 49ZM19 51L19 52L20 52L20 51ZM0 52L0 53L1 53L1 52ZM57 52L57 53L58 53L58 52ZM72 52L72 54L70 54L70 55L73 55L73 52ZM24 53L24 54L26 54L26 53ZM54 53L54 55L55 55L55 53ZM22 54L22 55L23 55L23 54ZM30 54L30 55L31 55L31 54ZM48 54L48 55L49 55L49 54ZM60 54L60 55L62 55L62 54ZM11 55L11 56L10 56L10 57L12 57L12 58L13 58L13 59L14 59L14 58L15 58L15 57L14 57L14 56L13 56L13 55ZM34 55L34 56L35 56L35 57L36 57L36 56L35 56L35 55ZM12 56L12 57L13 57L13 58L14 58L14 57L13 57L13 56ZM43 56L43 58L46 58L46 57L44 57L44 56ZM50 56L50 57L47 57L47 60L46 60L46 61L47 61L47 60L48 60L48 59L49 59L49 60L50 60L50 58L51 58L51 56ZM64 57L64 59L65 59L65 61L67 61L67 62L69 62L69 61L70 61L70 62L71 62L71 60L72 60L72 58L71 58L71 59L70 59L70 60L69 60L69 58L68 58L68 57L67 57L67 59L68 59L68 60L66 60L66 59L65 59L65 57ZM23 58L23 60L25 60L25 59L27 59L27 58L25 58L25 59L24 59L24 58ZM58 58L58 59L59 59L59 58ZM2 59L2 60L3 60L3 59ZM6 59L6 60L7 60L7 61L5 61L5 62L4 62L4 63L5 63L5 62L7 62L7 61L8 61L8 60L7 60L7 59ZM19 59L19 61L18 61L18 60L17 60L17 61L18 61L18 62L19 62L19 61L20 61L20 60L21 60L21 59ZM39 59L39 60L40 60L40 59ZM44 59L44 60L43 60L43 61L44 61L44 60L45 60L45 59ZM53 59L53 60L54 60L54 59ZM68 60L68 61L69 61L69 60ZM40 61L40 62L41 62L41 61ZM50 62L50 64L51 64L51 65L52 65L52 64L53 64L53 63L54 63L54 64L55 64L55 62ZM42 63L42 64L43 64L43 63ZM0 64L0 65L1 65L1 64ZM6 64L6 65L8 65L8 67L9 67L9 66L10 66L10 65L8 65L8 64ZM12 65L12 66L13 66L13 65ZM25 65L25 68L28 68L28 65ZM38 65L38 66L39 66L39 65ZM45 65L45 68L48 68L48 65ZM65 65L65 68L68 68L68 65ZM26 66L26 67L27 67L27 66ZM46 66L46 67L47 67L47 66ZM63 66L63 67L64 67L64 66ZM66 66L66 67L67 67L67 66ZM10 67L10 69L12 69L12 70L10 70L10 71L9 71L9 68L8 68L8 73L10 73L10 72L11 72L11 73L13 73L13 72L14 72L14 69L12 69L12 68L11 68L11 67ZM22 67L22 68L23 68L23 69L22 69L22 70L23 70L23 71L24 71L24 70L23 70L23 69L24 69L24 67ZM43 67L43 68L44 68L44 67ZM54 67L54 68L55 68L55 67ZM69 68L69 69L68 69L68 71L69 71L69 69L70 69L70 70L71 70L71 71L72 71L72 70L71 70L71 69L70 69L70 68ZM43 70L43 71L44 71L44 70ZM45 70L45 71L46 71L46 70ZM12 71L12 72L13 72L13 71ZM15 71L15 73L16 73L16 72L17 72L17 71ZM48 71L48 73L49 73L49 71ZM0 0L0 7L7 7L7 0ZM1 1L1 6L6 6L6 1ZM2 2L2 5L5 5L5 2ZM66 0L66 7L73 7L73 0ZM67 1L67 6L72 6L72 1ZM68 2L68 5L71 5L71 2ZM0 66L0 73L7 73L7 66ZM1 67L1 72L6 72L6 67ZM2 68L2 71L5 71L5 68Z" fill="#000000">
                                        </path>
                                    </g>
                                    </g>
                                </svg>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Setup Key</label>
                                <div class="input-group">
                                    <input type="text" name="key" value="CHUCNANGNAYCHUAHOATDONG" id="key" class="form-control form--control" readonly="">
                                    <button type="button" class="input-group-text copy" data-clipboard-target="#key"> <i class="fa fa-copy"></i> </button>
                                </div>
                            </div>

                            <label><i class="fa fa-info-circle"></i> Help</label>
                            <p>Google Authenticator là ứng dụng đa yếu tố dành cho thiết bị di động. Ứng dụng này tạo ra các mã có thời gian được sử dụng trong quá trình xác minh 2 bước. Để sử dụng Google Authenticator, hãy cài đặt ứng dụng Google Authenticator trên thiết bị di động của bạn. <a class="text--base" href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en" target="_blank">Tải xuống</a></p>
                        </div>

                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="settings-card">
                        <div class="settings-card-head">
                            <h4>Bật bảo mật 2FA</h4>
                        </div>
                        <div class="settings-card-body">
                        <div class="mb-3">
                                <label for="code" class="form-label">Google Authenticatior OTP </label>
                                <input type="text" class="form-control shadow-none" id="secret" name="secret" placeholder="Nhập mã xác thực" required="">
                            </div>
                            <div class="mb-3">
                                <button id="btnChange" class="btn btn-primary w-100" onclick="change2fa()">Bật 2FA</button>
                            </div>
                        </div>
                       
                    </div>
                </div>
              
            </div>

        </div>
    </section>
</main>
<script>
    function change2fa() {
        $('#btnChange').html('<i class="fa fa-spinner fa-spin"></i> Đang xử lý...').prop('disabled',
            true);
        $.ajax({
            url: "/ajaxs/client/authenticator.php",
            method: "POST",
            dataType: "JSON",
            data: {
                csrf_token: csrf_token,
                secret: $("#secret").val(),
                type: 'ChangeGoogle2FA'
            },
            success: function(respone) {
                if (respone.status == 'success') {
                    showMessage(respone.msg, 'success');
                    setTimeout("location.href = '';", 1000);
                } else {
                    showMessage(respone.msg, 'error');
                }
                $('#btnChange').html('Bật 2FA').prop('disabled', false);
            },
            error: function() {
                showMessage('Không thể xử lý', 'error');
                $('#btnChange').html('Bật 2FA').prop('disabled', false);
            }

        });
    }
</script>
<?php require_once __DIR__ . '/footer.php'; ?>